<?xml version="1.0"?>
<project>
	<depends>minilua.xml</depends>
	<depends>buildvm.xml</depends>
	<output type="static">luajit</output>
	<flags compiler="msvc">MT;W3</flags>
	<include>include</include>
	<flags type="pp" compiler="msvc">WIN32</flags>
	<flags type="pp">LUAJIT_ENABLE_LUA52COMPAT</flags>
	<prebuild os="win32">cd src $(CSEP) ..$(SEP)$(OUTPUT)$(SEP)buildvm -m peobj -o ../$(OUTPUT)/lj_vm.obj</prebuild>
	<prebuild os="linux">cd src $(CSEP) ..$(SEP)$(OUTPUT)$(SEP)buildvm -m elfasm -o ../$(OUTPUT)/lj_vm.s</prebuild>
	<prebuild os="linux">cd $(OUTPUT) $(CSEP) gcc -c lj_vm.s -o lj_vm.o</prebuild>
	<link compiler="msvc">$(OUTPUT)/lj_vm.obj</link>
	<link compiler="gcc">$(OUTPUT)/lj_vm.o</link>
	<prebuild>cd src $(CSEP) ..$(SEP)$(OUTPUT)$(SEP)buildvm -m bcdef -o ../include/lj_bcdef.h lib_base.c lib_math.c lib_bit.c lib_string.c lib_table.c lib_io.c lib_os.c lib_package.c lib_debug.c lib_jit.c lib_ffi.c $(CSEP) ..$(SEP)$(OUTPUT)$(SEP)buildvm -m ffdef -o ../include/lj_ffdef.h lib_base.c lib_math.c lib_bit.c lib_string.c lib_table.c lib_io.c lib_os.c lib_package.c lib_debug.c lib_jit.c lib_ffi.c $(CSEP) ..$(SEP)$(OUTPUT)$(SEP)buildvm -m libdef -o ../include/lj_libdef.h lib_base.c lib_math.c lib_bit.c lib_string.c lib_table.c lib_io.c lib_os.c lib_package.c lib_debug.c lib_jit.c lib_ffi.c $(CSEP) ..$(SEP)$(OUTPUT)$(SEP)buildvm -m recdef -o ../include/lj_recdef.h lib_base.c lib_math.c lib_bit.c lib_string.c lib_table.c lib_io.c lib_os.c lib_package.c lib_debug.c lib_jit.c lib_ffi.c $(CSEP) ..$(SEP)$(OUTPUT)$(SEP)buildvm -m vmdef -o jit\vmdef.lua lib_base.c lib_math.c lib_bit.c lib_string.c lib_table.c lib_io.c lib_os.c lib_package.c lib_debug.c lib_jit.c lib_ffi.c $(CSEP) ..$(SEP)$(OUTPUT)$(SEP)buildvm -m folddef -o ../include/lj_folddef.h lj_opt_fold.c</prebuild>
	<source f="src/lib_aux.c"/>
    <source f="src/lib_base.c"/>
    <source f="src/lib_bit.c"/>
    <source f="src/lib_debug.c"/>
    <source f="src/lib_ffi.c"/>
    <source f="src/lib_init.c"/>
    <source f="src/lib_io.c"/>
    <source f="src/lib_jit.c"/>
    <source f="src/lib_math.c"/>
    <source f="src/lib_os.c"/>
    <source f="src/lib_package.c"/>
    <source f="src/lib_string.c"/>
    <source f="src/lib_table.c"/>
    <source f="src/lj_alloc.c"/>
    <source f="src/lj_api.c"/>
    <source f="src/lj_asm.c"/>
    <source f="src/lj_bc.c"/>
    <source f="src/lj_bcread.c"/>
    <source f="src/lj_bcwrite.c"/>
    <source f="src/lj_carith.c"/>
    <source f="src/lj_ccall.c"/>
    <source f="src/lj_ccallback.c"/>
    <source f="src/lj_cconv.c"/>
    <source f="src/lj_cdata.c"/>
    <source f="src/lj_char.c"/>
    <source f="src/lj_clib.c"/>
    <source f="src/lj_cparse.c"/>
    <source f="src/lj_crecord.c"/>
    <source f="src/lj_ctype.c"/>
    <source f="src/lj_debug.c"/>
    <source f="src/lj_dispatch.c"/>
    <source f="src/lj_err.c"/>
    <source f="src/lj_ffrecord.c"/>
    <source f="src/lj_func.c"/>
    <source f="src/lj_gc.c"/>
    <source f="src/lj_gdbjit.c"/>
    <source f="src/lj_ir.c"/>
    <source f="src/lj_lex.c"/>
    <source f="src/lj_lib.c"/>
    <source f="src/lj_load.c"/>
    <source f="src/lj_mcode.c"/>
    <source f="src/lj_meta.c"/>
    <source f="src/lj_obj.c"/>
    <source f="src/lj_opt_dce.c"/>
    <source f="src/lj_opt_fold.c"/>
    <source f="src/lj_opt_loop.c"/>
    <source f="src/lj_opt_mem.c"/>
    <source f="src/lj_opt_narrow.c"/>
    <source f="src/lj_opt_sink.c"/>
    <source f="src/lj_opt_split.c"/>
    <source f="src/lj_parse.c"/>
    <source f="src/lj_record.c"/>
    <source f="src/lj_snap.c"/>
    <source f="src/lj_state.c"/>
    <source f="src/lj_str.c"/>
    <source f="src/lj_strscan.c"/>
    <source f="src/lj_tab.c"/>
    <source f="src/lj_trace.c"/>
    <source f="src/lj_udata.c"/>
    <source f="src/lj_vmevent.c"/>
    <source f="src/lj_vmmath.c"/>
</project>
